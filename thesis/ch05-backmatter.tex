%% ----------------------------------------------------------------------
%% START OF FILE
%% ----------------------------------------------------------------------
%% 
%% Filename: ch05-backmatter.tex
%% Author: Fred Qi
%% Created: 2012-12-26 13:08:53(+0800)
%% 
%% ----------------------------------------------------------------------
%%% CHANGE LOG
%% ----------------------------------------------------------------------
%% Last-Updated: 2012-12-26 13:10:54(+0800) [by Fred Qi]
%%     Update #: 9
%% ----------------------------------------------------------------------


\chapter{实验与结果分析}
\label{cha:backmatter}
\section{实验环境}
\subsection{实验硬件平台}
本实验的硬件环境由以下的工作站和pc节点组成的openstack平台。其中由8个工作站构成的计算节点和4台pc机组成的网络和控制节点。

其中工作站的配置如下所示：
\begin{table}[htp]
\begin{center}
\caption{计算节点的配置}
\begin{tabular}{|c|c|}
\hline
CPU & Intel\textregistered Xeon E5-2620 2.0GHZ\\
\hline
核数 & 24cores\\
\hline
内存 & 128GB\\
\hline
硬盘 &  2TB\\
\hline
\end{tabular}
\end{center}

\label{default}
\end{table}

网络和控制节点的配置如下表所示
\begin{table}[htp]
\begin{center}
\begin{tabular}{|c|c|}
\hline
CPU & Intel\textregistered Core TM i5-3470 3.2GHZ\\
\hline
核数 & 4cores\\
\hline
内存 & 4GB\\
\hline
硬盘 &  500GB\\
\hline
\end{tabular}
\end{center}
\caption{网络节点和控制节点配置}
\label{default}
\end{table}

\subsection{实验软件}
CBDRF调度算法和调度器采用了python的实现，所用的python的第三方库列举如下：
\begin{itemize}
\item Python-Tornado 

Tornado 是 FriendFeed 使用的可扩展的非阻塞式 web 服务器及其相关工具的开源版本。
主要用来进行进程间接受消息的WebAPI的通信基础。
\item Python-Requests 

这是一个Http请求的第三方库，用于进行进程间http通信。
\item Python-MySQLDB  

python连接数据库的第三方库。
\item Python-SQLAlchemy 

这是资源管理器连接资源监控的数据库的底层。
\item Python-Numpy 

Scipy的底层数学运算的实现，NumPy系统是Python的一种开源的数字扩展。这种工具可用来存储和处理大型矩阵
\item Python-Scipy 

Python的科学计算类库。Python scipy的科学计算应用。包括了数据处理,数值计算等内容,数字信号处理,快速傅立叶变换等应用。
\end{itemize}


\section{实验结果和分析}
本文从资源分配的公平性，资源利用情况和任务实际执行性能这
三个方面对CBDRF进行了测试和仿真。实验模拟生成若干个任务的请求，
分别采用openstack的资源调度器和CBDRF的调度器经行
对比。对比的结果如所示。
\subsection{资源公平性}
首先对分配的公平性进行测试。其结果如图所示

实验结果表明，基于DRF算法的分配算法在多资源的分配情况上与openstack的filter\_scheduler
相比，如果任务的请求对资源的需求的异质性越大，可以发现原始的基于单资源负载
均衡的调度算法在多资源的情况下分配的很不均衡，基于单资源的排序算法往往会导致其他
资源的负载均衡被破坏。从这里看出，基于DRF的多资源算法可以很好的调和异质任务间资源需求
的差距，同时可以保障分配均有良好的资源情况。


该图计算了基于CBDRF在资源分配的时各个计算节点的domainantShare的情况。
从图上可以看出，基于CBDRF上各个物理机的domainantShare非常均衡，稳定在25\%左右，
而原始的openstack的dominantShare则相差较大。表明，利用max-min进行公平性的
分配是合理比并且在实际中获取了不错的负载效果。

最后利用了Jain's系数计算了各个资源的分配的负载情况，可以看出，基于
CBDRF的分配的各个物理机上的公平指数较openstack的filter\_scheuler有较好的提升，
openstack的分配在单个内存的考虑上的负载较为平衡，但其他资源的考虑有所不足。

\subsection{资源利用率}
接下来针对DAG任务的资源利用情况进行模拟和仿真，任务采用多算法的协同求解的PO和MOM算法
进行测试得到的情况如图所示。

Graph1散点图查看DAG任务资源分配情况，实验结果表明，如果不进行合并操作的资源请求。整个
云平台的系统的资源几乎均是整个资源的叠加，而采用了合并操作的CBDRF算法来看，
基本上资源的整个情况为多个资源请求的最大值，在优化方面使得集群的被占用空闲
计算情况减少。
从整个平台可分配的任务数进行统计，由于CBDRF采用了资源复用的优化，使得一个DAG任务
不会一次得到全部的资源请求。而原始的DRF或是filter\_scheduler均未采用上述的优化，使得
在资源的分配过程中大量的资源被空闲计算占用，使得云计算平台的资源的可分配资源大大减少。

最后，计算测试资源实际利用情况。这里统计实际的空闲情况。采用基于多算法协同求解的PO和MoM任务进行
计算和统计。我们可以发现，由于任务的特殊性，原始不考虑DAG关系的任务的实际平台计算的利用情况大致
仅为采用合并操作的一半左右。这是由于大量的后置任务在等待前置任务的结束运行，造成了平台
计算资源的浪费。

\subsection{任务执行性能}
最后对任务执行的性能进行测试，这次测试采用通信量较多的FDTD算法的程序进行测试。

FDTD算法是典型的通信关联任务，采用通信的基于MPI的多节点程序进行测试。测试进行
20个任务进行调度，计算其运行的平均时间。实验结果表明，基于关联规则合并的CBDRF
较原先的任务将计算的时延优化了15\%左右，如果计算的过程中，通信量的增大会导致
优化进一步加大。原始的调度只考虑负载的运行状态，忽略了任务之间通信的关联性，
导致任务通信的代价成为计算性能的瓶颈。而CBDRF基于关联任务的合并，使得任务之间的数据局部性
得到了良好的保障，提高了整体的计算性能。
14  21  0.072917
13  12  0.067708
13  12  0.067708
15  15  0.078125
15  10  0.078125
15  28  0.078125
15  14  0.078125
15  18  0.078125
domain_jains 0.996458710066     
cpu_jains 0.996458710066        
mem_jains 0.89588634436     

13  20  0.067708
11  14  0.057292
15  14  0.078125
12  14  0.0625
7   16  0.036458
16  17  0.083333
23  17  0.119792
18  18  0.09375
domain_jains 0.909810126582     
cpu_jains 0.909810126582        
mem_jains 0.984389561976        


%% ----------------------------------------------------------------------
%%% END OF FILE 
%% ----------------------------------------------------------------------
